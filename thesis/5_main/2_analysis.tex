\section{Моделювання результатів виконання тестових завдань}

\subsection{Процес Пуассона}
Щоб моделювати темп виконання студентами контрольних задач, використаємо
відомі дані з психології щодо ритму виконання теппінг-тесту для людей
з різними типами вищої нервової діяльності.
Оскільки постукування є потоком однорідних випадкових подій, змоделюємо їх
як реалізації процесу Пуассона.

Нехай $\left\{ N\left( t \right) \vert t \ge 0 \right\}$ --- процес Пуассона з
інтенсивністю $\lambda\left( t \right)$.
Маємо $7$ контрольних точок на часовій вісі $t_0 = 0, t_1 = 5, \dots, t_6 = 30$.
Введемо відрізок часу $T$, за який проводиться вимірювання,
та проміжки $T_i$, на які його розбито в експерименті
\begin{equation*}
  T = \left( 0, 30 \right], \qquad
  T_i = \left( t_{i-1}, t_i \right], \qquad
  i = \overline{1, 6}.
\end{equation*}
Нехай $\nu_i$ визначається наступним чином
\begin{equation*}
  \nu_i = N\left( t_i \right) - N\left( t_{i-1} \right),
  \qquad i = \overline{1,6},
\end{equation*}
тоді $\nu_i$ --- випадкова величина, що має розподіл Пуассона з параметром
$\lambda_i$, де \cite{Bulinsky:2003}
\begin{equation*}
  \lambda_i
  = m\left( T_i \right)
  = \int\limits_{t_{i-1}}^{t_i} \lambda\left( \tau \right) \; d\tau, \qquad
  i = \overline{1, 6}.
\end{equation*}
Функція $m$ --- міра інтенсивності. \cite{Kingman:1992}

Проміжки $T_i$ утворюють розбиття множини $T$, а отже не перетинаються.
Це означає, що випадкові величини $\nu_i$ незалежні між собою,
і є можливість згенерувати процес натискання за допомогою $6$ незалежних
випадкових величин, що мають розподіл Пуассона.

Інтенсивність (параметр $\lambda$) є математичним очікуванням випадкової
величини, що має розподіл Пуассона.
Маючи результати реальних експериментів, можна обчислити середні значення
кількості постукувань для кожного часового проміжку $T_i$, а отримані
результати використовувати в якості параметрів $\lambda_i$.

Візьмемо значення відомого експерименту з підручника \cite{Ilin:2001}, які
зображено на рис. \ref{fig:tapping:Ilin01}.
Оскільки результат один, то його значення будуть середніми з вибірки, що
складається з одного вектора --- їх і використаємо в якості параметрів
$\lambda_i$.
На рис. \ref{fig:tapping:poisson} зображено різні реалізації послідовності
випадкових величин, що розподілені за законом Пуассона з параметрами
\begin{equation}\label{eq:tapping:poisson}
  \left[ \lambda_{1}, \lambda_{2}, \lambda_{3}, \lambda_{4}, \lambda_{5},
         \lambda_{6} \right]
  = \left[ 43, 40, 38, 37, 38, 35 \right].
\end{equation}

\begin{figure}[h]
  \centering
    \begin{tikzpicture}[scale=1]
      \begin{axis}[ymin=20, ymax=50, xmin=5, xmax=30, ytick=\empty,
        xmajorgrids={true},
        ylabel={Кількість точок}, ylabel near ticks,
        xlabel={час, с}]

        \draw[dashed,color=gray!50] ({rel axis cs:0,43}|-{axis cs:0,43})
                                 -- ({rel axis cs:1,43}|-{axis cs:0,43});
        \addplot table [x, y, col sep=comma] {data/chartIlinExample01.csv};
      \end{axis}
    \end{tikzpicture}
  \caption{Спадна ламана, побудована на основі даних з \cite{Ilin:2001}}
  \label{fig:tapping:Ilin01}
\end{figure}


\subsection{Квадратична апроксимація методом найменших квадратів}

Види результуючих ламаних (опукла, ввігнута, рівна, спадна) можна представити
квадратичними функціями виду
\begin{equation*}
  y\left( t \right) = a \cdot t^2 + b \cdot t + c.
\end{equation*}

На рис. \ref{fig:tapping:poisson:sqr} зображено реалізації послідовності
випадкових величин, що розподілені за законом Пуассона, та криві, що є
результатом апроксимації цих реалізацій.

\begin{figure}[h]
  \centering
  \begin{subfigure}[b]{0.45\textwidth}
    %\includegraphics[width=.75\textwidth]{code/least_squares_approximation}
    \includegraphics[width=\textwidth]{images/poisson}
    \caption{Без апроксимації}
    \label{fig:tapping:poisson}
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    %\includegraphics[width=.75\textwidth]{code/least_squares_approximation}
    \includegraphics[width=\textwidth]{images/poisson_approximation}
    \caption{З апроксимацією}
    \label{fig:tapping:poisson:sqr}
  \end{subfigure}
  \caption{Приклади результатів моделювання}
\end{figure}

Щоб представити результати у вигляді квадратичних функцій, використаємо
метод найменших квадратів.
Нехай $\left\{ y_i \mid i=\overline{1, 6} \right\}$ --- результати поточного
теппінг-тесту.
Суть методу полягає в знаходженні таких коефіцієнтів $a$, $b$ і $c$, з якими
наступна величина приймає мінімальне значення
\begin{equation*}
  R^2\left( a, b, c \right)
  = \sum_{i=1}^{6} \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)^2.
\end{equation*}
Для цього треба взяти часткові похідні по кожному коефіцієнту, прирівняти ці
похідні до нуля та розв’язати отриману систему
\begin{equation*}
  \begin{cases}
    \sum_{i=1}^{6} 2 \cdot \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)
    &= 0 \\
    \sum_{i=1}^{6} 2 \cdot t_i
      \cdot \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)
    &= 0 \\
    \sum_{i=1}^{6} 2 \cdot t_i^2
      \cdot \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)
    &= 0.
  \end{cases}
\end{equation*}
Цю систему можна переписати в матричному вигляді наступним чином
\begin{equation*}
  \begin{bmatrix}
    \sum_{i=1}^{6} t_i^2 & \sum_{i=1}^{6} t_i   & \sum_{i=1}^{6} 1 \\
    \sum_{i=1}^{6} t_i^3 & \sum_{i=1}^{6} t_i^2 & \sum_{i=1}^{6} t_i \\
    \sum_{i=1}^{6} t_i^4 & \sum_{i=1}^{6} t_i^3 & \sum_{i=1}^{6} t_i^2
  \end{bmatrix}
  \cdot
  \begin{bmatrix}
    a \\
    b \\
    c
  \end{bmatrix}
  =
  \begin{bmatrix}
    \sum_{i=1}^{6} y_i \\
    \sum_{i=1}^{6} y_i \cdot t_i \\
    \sum_{i=1}^{6} y_i \cdot t_i^2
  \end{bmatrix}.
\end{equation*}
Введемо позначення:
\begin{equation*}
  \begin{split}
    &\sum_{i=1}^{6} 1 = N, \\
    &\sum_{i=1}^{6} t_i^k = X^k,\qquad k=\overline{1, 4}, \\
    &\sum_{i=1}^{6} y_i \cdot t_i^k = YX^k,\qquad k=\overline{0, 2}.
  \end{split}
\end{equation*}
Рівняння прийняло наступний вигляд
\begin{equation*}
  \begin{bmatrix}
    X^2 & X   & N \\
    X^3 & X^2 & X \\
    X^4 & X^3 & X^2
  \end{bmatrix}
  \cdot
  \begin{bmatrix}
    a \\
    b \\
    c
  \end{bmatrix}
  =
  \begin{bmatrix}
    Y \\
    YX \\
    YX^2
  \end{bmatrix}.
\end{equation*}
Використаємо метод Крамера для розв’язання системи лінійних рівнянь.
Визначник $\Delta$
\begin{equation*}
  \begin{split}
    \Delta
    = X^2 \cdot \left( X^2 \cdot X^2 - X  \cdot X^3 \right)
       &- X \cdot \left( X^3 \cdot X^2 - X  \cdot X^4 \right) \\
       &+ N \cdot \left( X^3 \cdot X^3 - X^2 \cdot X^4 \right).
  \end{split}
\end{equation*}
Визначник $\Delta_a$
\begin{equation*}
  \begin{split}
    \Delta_a
    =     Y   \cdot \left( X^2 \cdot X^2 - X \cdot X^3 \right)
      &- YX   \cdot \left( X   \cdot X^2 - N \cdot X^3 \right) \\
      &+ YX^2 \cdot \left( X   \cdot X   - N \cdot X^2 \right).
  \end{split}
\end{equation*}
Визначник $\Delta_b$
\begin{equation*}
  \begin{split}
    \Delta_b
    =  -  Y   \cdot \left( X^3 \cdot X^2 - X \cdot X^4 \right)
      &+ YX   \cdot \left( X^2 \cdot X^2 - N \cdot X^4 \right) \\
      &- YX^2 \cdot \left( X^2 \cdot X   - N \cdot X^3 \right).
  \end{split}
\end{equation*}
Визначник $\Delta_c$
\begin{equation*}
  \begin{split}
    \Delta_c
    =     Y   \cdot \left( X^3 \cdot X^3 - X^2 \cdot X^4 \right)
      &- YX   \cdot \left( X^2 \cdot X^3 - X   \cdot X^4 \right) \\
      &+ YX^2 \cdot \left( X^2 \cdot X^2 - X   \cdot X^3 \right).
  \end{split}
\end{equation*}
Відомо, що розв’язками є наступні вирази
\begin{equation*}
  a = \frac{\Delta_a}{\Delta},\qquad
  b = \frac{\Delta_b}{\Delta},\qquad
  c = \frac{\Delta_c}{\Delta}.
\end{equation*}
Бачимо, що параметри --- лінійні комбінації $y_i$, а коефіцієнти при $y_i$ ---
раціональні дроби.
Тобто можна записати розв’язки наступним чином
\begin{equation*}
  a = \sum_{i=1}^{6} y_i \cdot \frac{a_i}{\Delta},\qquad
  b = \sum_{i=1}^{6} y_i \cdot \frac{b_i}{\Delta},\qquad
  c = \sum_{i=1}^{6} y_i \cdot \frac{c_i}{\Delta}.
\end{equation*}

\subsection{Аналіз квадратичної апроксимації}

Запишемо умови, що накладаються на $a$, $b$ і $c$, за якиих отримана
парабола відповідає раніше введеним типам вищої нервової діяльності.
Введемо такі позначення: $t_{max}$ і $t_{min}$ --- точки, в яких парабола
досягає локального максимуму та мінімуму на відрізку $\left[ t_1, t_6 \right]$
відповідно.
$\varepsilon = 1$ буде відповідати відхиленню від початкового
значення функції, яке вважається суттєвим.
$t_1$ і $t_6$, як і раніше, є точками першого та останнього спостереження
відповідно.

Пряма ламана весь час тримається приблизно на початковому рівні
\begin{equation*}
  \begin{cases}
    y\left( t_{max} \right) - y\left( t_1 \right) \le \varepsilon, \\
    y\left( t_1 \right) - y\left( t_{min} \right) \le \varepsilon.
  \end{cases}
\end{equation*}

Спадна ламана спадає після моменту $t_1$, і не повертається до початкового
положення
\begin{equation*}
  \begin{cases}
    t_{max} = t_1, \\
    y\left( t_{max} \right) - y\left( t_{min} \right) > \varepsilon.
  \end{cases}
\end{equation*}

Проміжна ламана спочатку зростає, потім не пізніше моменту часу $t_3$ починає
спадати нижче початкового рівня
\begin{equation*}
  \begin{cases}
    t_2 \le t_{max} \le t_3 < t_{min}, \\
    y\left( t_{max} \right) - y\left( t_1\right) > \varepsilon, \\
    y\left( t_1 \right) - y\left( t_{min} \right) > \varepsilon.
  \end{cases}
\end{equation*}

Опукла ламана спочатку зростає, не пізніше моменту $t_3$ починає спадати,
а до моменту $t_6$ повертається до початкового рівня або спадає нижче нього.
\begin{equation*}
  \begin{cases}
    t_3 \le t_{max}, \\
    y\left( t_{max} \right) - y\left( t_1\right) > \varepsilon, \\
    y\left( t_6 \right) \le y\left( t_1 \right).
  \end{cases}
\end{equation*}

Звичайним диференціюванням поліному $y$ знаходимо точку його глобального
екстремуму
\begin{equation*}
  \left. \frac{dy}{dt} \right|_{t_g} = 2 \cdot a \cdot t_g + b = 0
  \Rightarrow t_g = - \frac{b}{2 \cdot a}.
\end{equation*}
Якщо коефіцієнт $a$ від’ємний, то це означає, що точка $t_g$ --- точка
глобального максимуму, якщо додатній, $t_g$ --- точка глобального мінімуму.
В противному випадку, якщо $a = 0$, глобального екстремуму немає.

Введемо множину критичних точок $C$
\begin{equation*}
  C =
  \begin{cases}
    \left\{ t_1, t_6, t_g \right\}, & t_1 < t_g < t_6, \qquad a \neq 0  \\
    \left\{ t_1, t_6 \right\},      & otherwise
  \end{cases}
\end{equation*}
В такому випадку знаходження точки максимуму (мінімуму) функції $y$ зводиться до
її максимізації (мінімізації) по множині, що складається з $2$-$3$ елементів
\begin{equation*}
  t_{max} = \argmax\limits_{t \in C} y\left( t \right), \qquad
  t_{min} = \argmin\limits_{t \in C} y\left( t \right).
\end{equation*}

Було згенеровано $6$ вибірок по $100$ реалізацій процесу Пуассона з
інтенсивністю, яку було вказано у формулі \eqref{eq:tapping:poisson} для
подальшої класифікації та порівняння отриманих даних з відомими.
Результати класифікації можна побачити на рис. \ref{fig:tapping:poisson:types}.
На рис. \ref{fig:tapping:poisson:types:log} зображено дані класифікації
всієї сукупності з $600$ траєкторій з логарифмічною шкалою.

Опис:
\begin{itemize}
  \item
    Не вдалося віднести до тієї чи іншої групи біля $16\%$ траєкторій
  \item
    Найбільш розповсюджений вид --- спадна ламана, що зустрілася у $60\%$
    випадків
  \item
    Біля $15\%$ ламаних --- проміжні
  \item
    Опуклі ламані виникали у $7\%$
  \item
    Прямі з’явилися в $1\%$ випадків
\end{itemize}

%\begin{figure}[h]
%  \centering
%    \includegraphics[width=\textwidth]{images/poisson_types}
%    \caption{Розбиття траєкторій по вибірках}
%    \label{fig:tapping:poisson:types}
%\end{figure}

\begin{figure}[h]
  \centering
  \begin{subfigure}[b]{0.45\textwidth}
    \includegraphics[width=\textwidth]{images/poisson_types}
    \caption{Звичайна школа}
    \label{fig:tapping:poisson:types}
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    \includegraphics[width=\textwidth]{images/poisson_types_log}
    \caption{Логарифмічна шкала}
    \label{fig:tapping:poisson:types:log}
  \end{subfigure}
  \caption{Розбиття траєкторій по класах}
\end{figure}
